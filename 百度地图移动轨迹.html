<!DOCTYPE html>
<html>
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <meta name="viewport" content="initial-scale=1.0, user-scalable=no" />
    <style type="text/css">
      body,
      html,
      #allmap {
        width: 100%;
        height: 100%;
        overflow: hidden;
        margin: 0;
        font-family: '微软雅黑';
      }
      #control {
        position: absolute;
        top: 10px;
        left: 10px;
        z-index: 999;
      }
    </style>
    <script
      type="text/javascript"
      src="http://api.map.baidu.com/api?v=3.0&ak=5rQ58KpwMGBWUZiOzaCagbuakMiNCKK3"
    ></script>
    <script
      type="text/javascript"
      src="http://api.map.baidu.com/api?type=webgl&v=1.0&ak=5rQ58KpwMGBWUZiOzaCagbuakMiNCKK3"
    ></script>
    <title>视角动画</title>
  </head>
  <body>
    <div id="allmap"></div>
    <!-- <div id="control">
      <input type="button" onclick="showOver()" value="显示" />
      <input type="button" onclick="hideOver()" value="隐藏" />
    </div> -->
  </body>
</html>
<script type="text/javascript">
  const iconImg = 'us_mk_icon.png'
  // 数据点
  var path = [
    {
      lng: 126.533262,
      lat: 43.843651,
    },
    {
      lng: 126.533262,
      lat: 43.843651,
    },
    {
      lng: 126.533262,
      lat: 43.843651,
    },
    {
      lng: 126.533262,
      lat: 43.843651,
    },
    {
      lng: 126.537391,
      lat: 43.845061,
    },
    {
      lng: 126.533262,
      lat: 43.843651,
    },
    {
      lng: 126.533262,
      lat: 43.843651,
    },
  ]
  var point = []
  for (var i = 0; i < path.length; i++) {
    point.push(new BMapGL.Point(path[i].lng, path[i].lat))
  }

  // 初始化, 按住鼠标右键，修改倾斜角和角度
  var bmap = new BMapGL.Map('allmap') // 创建Map实例
  bmap.centerAndZoom(point[3], 16) // 初始化地图,设置中心点坐标和地图级别
  bmap.enableScrollWheelZoom(true) // 开启鼠标滚轮缩放

  // 获得图标
  function getIcon() {
    var icon = new BMapGL.Icon(iconImg, new BMapGL.Size(23, 25), {
      offset: new BMapGL.Size(13, 22),
      imageOffset: new BMapGL.Size(0, 21),
    })
    return icon
  }

  // 添加标注
  function addMarker(point) {
    var marker = new BMapGL.Marker(point,{
      title: '用户1'
    })
    bmap.addOverlay(marker)
  }

  // 随机颜色
  function getColor() {
    var colorValue = '0,1,2,3,4,5,6,7,8,9,a,b,c,d,e,f'
    var colorArray = colorValue.split(',')
    var color = '#'
    for (var i = 0; i < 6; i++) {
      color += colorArray[Math.floor(Math.random() * 16)]
    }
    return color
  }

  // 轨迹线
  function addPolyline() {
    var pl = new BMapGL.Polyline(point, {
      strokeColor: getColor(),
      strokeWeight: 4,
      strokeOpacity: 0.8,
    })
    bmap.addOverlay(pl)
  }
  // 所有标注
  function addAllMarker() {
    // 自定义添加起点的标注点
    var marker2 = new BMapGL.Marker(point[0], { icon: getIcon() }) //起点
    bmap.addOverlay(marker2)

    // 其他所有标记点
    for (let i = 1, l = point.length; i < l; i++) {
      addMarker(point[i])
    }
  }

  function initMap() {
    addPolyline()
    addAllMarker()
  }
  initMap()
</script>
